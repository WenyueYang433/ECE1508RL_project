--- Starting Fine-Tuning Pipeline ---
Base Model: /Users/lingyunguo/Documents/ECE1508RL_project/models/GRU_DDQN_20251202_175724.pt
Output Model: /Users/lingyunguo/Documents/ECE1508RL_project/models/GRU_DDQN_20251202_175724_finetuned.pt
Arch: GRU | Steps=2000, LR=1e-05, Margin=0.5
--- Loading Data (Top 1000 movies, Min 5 ratings) ---
Total unique movies with ratings before filtering: 9724
Filtered to top 1000 movies. Remaining Ratings: 61256
Filtered users with < 5 ratings. Ratings dropped: 3
Generating Hard Negatives...
Building CF candidates for 507 users (this may take a minute)...
Loaded Base Model weights from /Users/lingyunguo/Documents/ECE1508RL_project/models/GRU_DDQN_20251202_175724.pt
Evaluating Base Model Performance...
Base Precision@10: 0.1958 | Base NDCG@10: 0.2081
Starting Fine-Tuning (2000 steps)...
Step 200/2000 | Hinge Loss: 0.3473
  > Eval: Precision@10=0.1708 | NDCG@10=0.1778
  > New Best Model Saved!
Step 400/2000 | Hinge Loss: 0.3786
  > Eval: Precision@10=0.1917 | NDCG@10=0.1873
  > New Best Model Saved!
Step 600/2000 | Hinge Loss: 0.4255
  > Eval: Precision@10=0.1708 | NDCG@10=0.1682
Step 800/2000 | Hinge Loss: 0.3462
  > Eval: Precision@10=0.1750 | NDCG@10=0.1694
Step 1000/2000 | Hinge Loss: 0.3256
  > Eval: Precision@10=0.1750 | NDCG@10=0.1676
Step 1200/2000 | Hinge Loss: 0.3960
  > Eval: Precision@10=0.1750 | NDCG@10=0.1696
Step 1400/2000 | Hinge Loss: 0.2732
  > Eval: Precision@10=0.1583 | NDCG@10=0.1583
Step 1600/2000 | Hinge Loss: 0.3519
  > Eval: Precision@10=0.1708 | NDCG@10=0.1672
Step 1800/2000 | Hinge Loss: 0.2534
  > Eval: Precision@10=0.1833 | NDCG@10=0.1708
Step 2000/2000 | Hinge Loss: 0.2162
  > Eval: Precision@10=0.1667 | NDCG@10=0.1571
Fine-tuning complete. Best model saved to /Users/lingyunguo/Documents/ECE1508RL_project/models/GRU_DDQN_20251202_175724_finetuned.pt

Loading best fine-tuned model for final report...
Running full validation on Best Model...

=== Final Fine-Tuned Results ===
Precision@10: 0.1917
Recall@10: 0.0648
NDCG@10: 0.1873
MAP@10: 0.1057
HitRate: 0.6667
Coverage@Catalog: 0.1000
Coverage@User: 0.0100
Popularity: 4.7063
Novelty: 0.8656
Diversity(ILD): 0.5319

Top-20 Recommended MovieIDs (After): [(np.int64(260), 202), (np.int64(527), 184), (np.int64(1), 170), (np.int64(1196), 169), (np.int64(318), 165), (np.int64(1198), 165), (np.int64(480), 164), (np.int64(2959), 154), (np.int64(858), 148), (np.int64(50), 144), (np.int64(1356), 142), (np.int64(1617), 137), (np.int64(541), 116), (np.int64(3793), 114), (np.int64(1210), 109), (np.int64(110), 107), (np.int64(2028), 103), (np.int64(4306), 82), (np.int64(6377), 81), (np.int64(2571), 80)]
