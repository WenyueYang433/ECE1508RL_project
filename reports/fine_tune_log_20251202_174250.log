--- Starting Fine-Tuning Pipeline ---
Base Model: /Users/lingyunguo/Documents/ECE1508RL_project/models/Dueling_DDQN_20251202_173940.pt
Output Model: /Users/lingyunguo/Documents/ECE1508RL_project/models/Dueling_DDQN_20251202_173940_finetuned.pt
Arch: Dueling | Steps=2000, LR=1e-05, Margin=0.5
--- Loading Data (Top 1000 movies, Min 5 ratings) ---
Total unique movies with ratings before filtering: 9724
Filtered to top 1000 movies. Remaining Ratings: 61256
Filtered users with < 5 ratings. Ratings dropped: 3
Generating Hard Negatives...
Building CF candidates for 507 users (this may take a minute)...
Loaded Base Model weights from /Users/lingyunguo/Documents/ECE1508RL_project/models/Dueling_DDQN_20251202_173940.pt
Evaluating Base Model Performance...
Base Precision@10: 0.1792 | Base NDCG@10: 0.2080
Starting Fine-Tuning (2000 steps)...
Step 200/2000 | Hinge Loss: 0.4174
  > Eval: Precision@10=0.1625 | NDCG@10=0.1921
  > New Best Model Saved!
Step 400/2000 | Hinge Loss: 0.4001
  > Eval: Precision@10=0.1542 | NDCG@10=0.1822
Step 600/2000 | Hinge Loss: 0.3315
  > Eval: Precision@10=0.1500 | NDCG@10=0.1848
Step 800/2000 | Hinge Loss: 0.3751
  > Eval: Precision@10=0.1542 | NDCG@10=0.1804
Step 1000/2000 | Hinge Loss: 0.3659
  > Eval: Precision@10=0.1583 | NDCG@10=0.1825
Step 1200/2000 | Hinge Loss: 0.4033
  > Eval: Precision@10=0.1542 | NDCG@10=0.1751
Step 1400/2000 | Hinge Loss: 0.3090
  > Eval: Precision@10=0.1458 | NDCG@10=0.1652
Step 1600/2000 | Hinge Loss: 0.3945
  > Eval: Precision@10=0.1375 | NDCG@10=0.1547
Step 1800/2000 | Hinge Loss: 0.3398
  > Eval: Precision@10=0.1292 | NDCG@10=0.1430
Step 2000/2000 | Hinge Loss: 0.3973
  > Eval: Precision@10=0.1208 | NDCG@10=0.1340
Fine-tuning complete. Best model saved to /Users/lingyunguo/Documents/ECE1508RL_project/models/Dueling_DDQN_20251202_173940_finetuned.pt

Loading best fine-tuned model for final report...
Running full validation on Best Model...

=== Final Fine-Tuned Results ===
Precision@10: 0.1625
Recall@10: 0.0554
NDCG@10: 0.1921
MAP@10: 0.1142
HitRate: 0.5833
Coverage@Catalog: 0.0840
Coverage@User: 0.0100
Popularity: 4.7085
Novelty: 0.8631
Diversity(ILD): 0.5576

Top-20 Recommended MovieIDs (After): [(np.int64(858), 248), (np.int64(318), 243), (np.int64(58559), 186), (np.int64(1197), 177), (np.int64(2028), 173), (np.int64(1), 163), (np.int64(260), 144), (np.int64(1221), 136), (np.int64(356), 135), (np.int64(527), 134), (np.int64(2959), 128), (np.int64(4226), 127), (np.int64(1196), 124), (np.int64(50), 119), (np.int64(296), 118), (np.int64(110), 117), (np.int64(541), 111), (np.int64(593), 89), (np.int64(1136), 88), (np.int64(1208), 80)]
